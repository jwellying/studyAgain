### 进程
进程是什么？
- 进程是为程序的运行提供必备的环境
- 进程之间是相互独立的，各自拥有自己的资源

### 线程
线程是什么？
- 线程是计算机中的最小计算单位，线程负责执行代码
- 同一个进程的线程之间很多时候是协同工作的

### 想象环节
- 用一个比喻来概括，我们把进程比作一个车间，那么线程就是车间中的工人
车间为工人的工作提供了资源，车间有一个或者多个工人，工人共享资源，协作工作；

### 从实际场景中看进程与线程
当我们打开电脑的任务管理器时，我们可以看到许多的进程，以及进程占cpu、内存情况
由此我们可以联想到之前的说法，进程为程序的运行提供必备的环境资源，这个资源的就是
**内存的分配(应该还有cpu等其他资源的分配)**
重要的两点结论：
1. 进程是cpu资源分配的最小单位(进程是拥有独立资源和独立运行的最小单位)
2. 线程cpu调度的最小单位

由此我们可以引申出单线程和多线程的概念
典型的单线程：js是单线程

### 浏览器是多进程的
每当我们打开一个tab页，我们就开启了一个进程(当然实际在浏览器中进程可能会被合并)
那么浏览器包含了那些进程呢？
+ browser进程
    1. 负责浏览器的页面显示，与用户交互、前进或回退
    2. 页面的管理，进程的创建与销毁
    3. 渲染进程中拿到bitmap，渲染到用户界面
    4. 网络资源的管理与下载
+ **渲染进程(多线程)**
    页面渲染、事件处理、脚本执行
+ GPU进程：主要用于3D绘制
+ 第三方插件的进程

其中我们最需要关注的就是渲染进程
渲染进程所需要处理的页面渲染、事件处理、脚本执行就是我们前端一直在操控的事情
首先对于渲染进程来说，它是多线程的:
+ GUI渲染线程
    1. 负责渲染浏览器界面，解析HTML，CSS，构建DOM树和RenderObject树，布局和绘制等。
    2. 当界面需要重绘（Repaint）或由于某种操作引发回流(reflow)时，该线程就会执行
    3. GUI渲染线程与JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起（相当于被冻结了），GUI更新会被保存在一个队列中等到JS引擎空闲时立即被执行。(即我们平常所说的页面解析时，遇到js会停止当前的渲染行为)
+ js引擎线程
+ 事件处理线程
+ 定时器线程
+ ajax请求的线程

### 浏览器进程与渲染进程之间的通信
从用户打开一个页面分析，浏览器进程收到用户请求，首先需要获取页面(通过下载资源等方式)，将该任务通过renderHost传递给render进程，Renderer进程的Renderer接口收到消息，简单解释后，交给渲染线程，然后开始渲染
渲染线程接收请求，加载网页并渲染网页，这其中可能需要Browser进程获取资源和需要GPU进程来帮助渲染
当然可能会有JS线程操作DOM（这样可能会造成回流并重绘）
最后Render进程将结果传递给Browser进程
Browser进程接收到结果并将结果绘制出来

### 线程之间的关系
渲染线程与js线程互斥(可以联想到骨架屏、预渲染等优化)

#### webWorker(了解)
当js中的内容复杂计算时间很长时，容易发生渲染阻塞，为此H5中提出了webWorker
+ 创建Worker时(通过new一个worker对象的形式)，JS引擎向浏览器申请开一个子线程（子线程是浏览器开的，完全受主线程控制，而且**不能操作DOM**）
+ JS引擎线程与worker线程间通过特定的方式通信（postMessage API，需要通过序列化对象来与线程交互特定的数据）

[！掘金参考文](https://juejin.im/post/5a6547d0f265da3e283a1df7)

