# vue中的diff算法
diff算法中每个节点由key和标签名来区分
虚拟dom的结构
```js
    tag:'div',
    data:{class:'item'},
    children:[
        {
            tag:'p',
            data:{class:'text'},
            children:['text-content']
        }
    ]
```
在diff讲解之前我们需要知道的两点假设：
+ 相同的组件拥有相同的dom结构，不同的组件拥有不同的dom结构
+ diff的比较是同级间的比较，即我们默认一般对dom的操作是不会跨级的
基于这两点，diff算法在vue中是十分高效的

# diff算法的比较规则

新旧dom树在同层的比较主要有以下几种情形：
1. 新旧结点的key和标签名都相同，说明没有改变，复用原来的结点结构；(vue的就地复用)
2. 比较当前结点的孩子结点
    + 新树有孩子结点，旧树没有孩子结点，那么将新树的孩子结点添加到旧树中
    + 新树没有孩子结点，旧树有孩子结点，那么将孩子结点删除；
    + 新树和旧树都有孩子结点(最复杂)
    vue使用双指针的方式，比较有四种情形：
    1. newFirst = oldFirst(队头比较)
    如果比较得到队头相等，index+1
    2. newLast = oldLast(队尾比较)
    如果比较得到队尾相等，index-1
    3. newFirst = oldLast/newLast = oldFirst(交叉比较)
    如果交叉比较相等，则将节点提升到相应的位置
    4. 都不相等
    从队头开始做个比较直至找到
    **新树中有而旧树中没有的结点会被创建，新树中没有而旧树中有的结点会被批量删除**
孩子结点的比较是一个递归的过程
